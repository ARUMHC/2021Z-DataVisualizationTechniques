

pp_1_data <- data.frame(a = c(15, 10, 8, 10, 10, 10, 10, 10, 12, 10, 11, 10, 7, 7, 7, 8), 
                        b = c(20, 20, 21, 20, 20, 23, 20, 15, 20, 20, 18, 25, 23, 20, 20, 16), 
                        c = c(20, 25, 25, 25, 25, 25, 25, 25, 23, 25, 24, 30, 25, 25, 25, 25), 
                        d = c(45, 45, 46, 45, 45, 45, 45, 50, 45, 45, 47, 45, 45, 48, 48, 43))

pp_2_data <- data.frame(a = c(5.0, 5.0, 4.0, 4.0, 5.0, 5.0, 4.0, 5.0, 4.0, 5.0, 6.0, 4.0, 3.0, 5.0, 4.0, 5.0, 5.0),
                        b = c(10.0, 12.0, 9.0, 10.0, 10.0, 8.0, 8.0, 8.0, 8.0, 10.0, 12.0, 8.0, 7.0, 10.0, 8.0, 17.0, 10.0),
                        c = c(20.0, 20.0, 16.0, 22.0, 15.0, 17.0, 16.0, 18.0, 15.0, 15.0, 20.0, 16.0, 20.0, 20.0, 17.0, 20.0, 15.0),
                        d = c(28.0, 25.0, 27.0, 24.0, 30.0, 27.0, 28.0, 27.0, 33.0, 30.0, 28.0, 27.0, 30.0, 30.0, 27.0, 28.0, 30.0),
                        e = c(37.0, 38.0, 44.0, 40.0, 40.0, 43.0, 44.0, 42.0, 40.0, 40.0, 34.0, 40.0, 40.0, 35.0, 44.0, 40.0, 40.0))

pp_3_data <- data.frame(a = c(7.0, 5.0, 8.0, 5.0, 10.0, 5.0, 7.0, 7.0, 5.0, 7.0, 9.0, 7.0, 3.0, 8.0, 8.0, 8.0, 5.0),
                        b = c(11.0, 7.0, 12.0, 15.0, 15.0, 10.0, 11.0, 10.0, 10.0, 13.0, 10.0, 10.0, 7.0, 12.0, 10.0, 12.0, 10.0),
                        c = c(19.0, 28.0, 20.0, 25.0, 30.0, 20.0, 26.0, 18.0, 25.0, 20.0, 15.0, 17.5, 20.0, 20.0, 20.0, 20.0, 20.0),
                        d = c(63.0, 60.0, 60.0, 65.0, 45.0, 65.0, 66.0, 65.0, 60.0, 60.0, 66.0, 66.0, 70.0, 60.0, 62.0, 60.0, 65.0))

pp_4_data <- data.frame(a = c(2.0, 2.0, 2.0, 3.0, 1.0, 4.0, 2.0, 2.0, 3.0, 4.0, 3.0, 3.0, 5.0, 3.0, 2.0, 3.0, 2.5),
                        b = c(22.0, 20.0, 22.0, 22.0, 24.0, 19.0, 22.0, 21.0, 23.0, 20.0, 21.0, 15.0, 20.0, 21.0, 21.0, 22.0, 20.0),
                        c = c(24.0, 25.0, 25.0, 25.0, 25.0, 25.0, 23.0, 25.0, 20.0, 25.0, 23.0, 26.0, 23.0, 25.0, 25.0, 25.0, 25.0),
                        d = c(26.0, 27.0, 27.0, 26.0, 25.0, 26.0, 27.0, 26.0, 25.0, 25.0, 24.0, 29.0, 27.0, 26.0, 26.0, 25.0, 27.0),
                        e = c(26.0, 26.0, 24.0, 24.0, 25.0, 25.0, 26.0, 26.0, 29.0, 26.0, 29.0, 27.0, 25.0, 25.0, 26.0, 25.0, 27.0))

bp_1_data <- data.frame(a = c(10.0, 10.0, 10.0, 5.0, 15.0, 10.0, 10.0, 10.0, 10.0, 10.0, 7.0, 10.0, 9.0, 10.0, 10.0),
                        b = c(20.0, 20.0, 20.0, 15.0, 20.0, 17.0, 20.0, 20.0, 20.0, 20.0, 21.0, 20.0, 19.0, 20.0, 20.0),
                        c = c(25.0, 25.0, 25.0, 25.0, 25.0, 25.0, 25.0, 25.0, 25.0, 25.0, 25.0, 25.0, 25.0, 25.0, 25.0),
                        d = c(45.0, 45.0, 45.0, 45.0, 45.0, 48.0, 45.0, 45.0, 45.0, 45.0, 47.0, 45.0, 47.0, 45.0, 45.0))

bp_2_data <- data.frame(a = c(7.0, 5.0, 4.0, 5.0, 5.0, 7.0, 5.0, 5.0, 5.0, 6.0, 5.0, 5.0, 5.0, 5.0, 5.0),
                        b = c(13.0, 10.0, 11.0, 15.0, 10.0, 10.0, 8.0, 9.0, 8.0, 9.0, 10.0, 9.0, 9.0, 10.0, 14.0),
                        c = c(19.0, 15.0, 18.0, 25.0, 20.0, 15.0, 16.0, 17.0, 15.0, 15.0, 19.0, 18.0, 17.0, 15.0, 22.0),
                        d = c(26.0, 30.0, 27.0, 35.0, 30.0, 27.0, 28.0, 27.0, 28.0, 30.0, 28.0, 28.0, 28.0, 20.0, 29.0),
                        e = c(35.0, 40.0, 40.0, 45.0, 45.0, 41.0, 43.0, 42.0, 44.0, 40.0, 38.0, 40.0, 41.0, 50.0, 40.0))

bp_3_data <- data.frame(a = c(7.0, 8.0, 7.0, 4.0, 5.0, 10.0, 8.0, 7.0, 8.0, 8.0, 5.0, 12.0, 7.0, 7.0, 7.0),
                        b = c(10.0, 12.0, 10.0, 6.0, 10.0, 12.0, 10.0, 10.0, 10.0, 12.0, 8.0, 14.0, 13.0, 9.0, 10.0),
                        c = c(18.0, 14.0, 18.0, 25.0, 15.0, 20.0, 18.0, 18.0, 20.0, 20.0, 20.0, 21.0, 20.0, 19.0, 20.0),
                        d = c(65.0, 66.0, 65.0, 65.0, 70.0, 58.0, 64.0, 65.0, 62.0, 60.0, 67.0, 63.0, 60.0, 65.0, 63.0))

bp_4_data <- data.frame(a = c(3.0, 3.0, 3.0, 5.0, 3.0, 2.0, 2.0, 2.0, 3.0, 3.0, 3.0, 5.0, 4.0, 3.0, 3.0),
                        b = c(20.0, 19.0, 20.0, 20.0, 19.0, 19.0, 21.0, 19.0, 20.0, 20.0, 18.0, 18.0, 17.0, 20.0, 20.0),
                        c = c(25.0, 25.0, 25.0, 25.0, 25.0, 25.0, 25.0, 25.0, 25.0, 25.0, 25.0, 25.0, 25.0, 25.0, 25.0),
                        d = c(26.0, 27.0, 26.0, 25.0, 26.0, 27.0, 26.0, 27.0, 26.0, 26.0, 27.0, 26.0, 27.0, 26.0, 26.0),
                        e = c(26.0, 27.0, 26.0, 25.0, 26.0, 27.0, 26.0, 27.0, 26.0, 26.0, 27.0, 26.0, 27.0, 26.0, 26.0))


library(dplyr)
pp_1_data <- pp_1_data %>%
  mutate(blad_a=abs(a-10), blad_b=abs(b-20), blad_c=abs(c-25), blad_d=abs(d-45))
pp_1_errors <- pp_1_data %>%
  summarise(a = mean(blad_a), b = mean(blad_b), 
            c = mean(blad_c), d = mean(blad_d)) 


pp_2_data <- pp_2_data %>%
  mutate(blad_a=abs(a-5), blad_b=abs(b-9), blad_c=abs(c-17), blad_d=abs(d-28), blad_e=abs(e-41))
pp_2_errors <- pp_2_data %>%
  summarise(a = mean(blad_a), b = mean(blad_b), 
            c = mean(blad_c), d = mean(blad_d),
            e = mean(blad_e)) 


pp_3_data <- pp_3_data %>%
  mutate(blad_a=abs(a-7), blad_b=abs(b-10), blad_c=abs(c-19), blad_d=abs(d-64))
pp_3_errors <- pp_3_data %>%
  summarise(a = mean(blad_a), b = mean(blad_b), 
            c = mean(blad_c), d = mean(blad_d))


pp_4_data <- pp_4_data %>%
  mutate(blad_a=abs(a-2), blad_b=abs(b-21), blad_c=abs(c-25), blad_d=abs(d-26), blad_e=abs(e-26))
pp_4_errors <- pp_4_data %>%
  summarise(a = mean(blad_a), b = mean(blad_b), 
            c = mean(blad_c), d = mean(blad_d),
            e = mean(blad_e))

bp_1_data <- bp_1_data %>%
  mutate(blad_a=abs(a-10), blad_b=abs(b-20), blad_c=abs(c-25), blad_d=abs(d-45))
bp_1_errors <- bp_1_data %>%
  summarise(a = mean(blad_a), b = mean(blad_b), 
            c = mean(blad_c), d = mean(blad_d)) 


bp_2_data <- bp_2_data %>%
  mutate(blad_a=abs(a-5), blad_b=abs(b-9), blad_c=abs(c-17), blad_d=abs(d-28), blad_e=abs(e-41))
bp_2_errors <- bp_2_data %>%
  summarise(a = mean(blad_a), b = mean(blad_b), 
            c = mean(blad_c), d = mean(blad_d),
            e = mean(blad_e)) 


bp_3_data <- bp_3_data %>%
  mutate(blad_a=abs(a-7), blad_b=abs(b-10), blad_c=abs(c-19), blad_d=abs(d-64))
bp_3_errors <- bp_3_data %>%
  summarise(a = mean(blad_a), b = mean(blad_b), 
            c = mean(blad_c), d = mean(blad_d))


bp_4_data <- bp_4_data %>%
  mutate(blad_a=abs(a-2), blad_b=abs(b-21), blad_c=abs(c-25), blad_d=abs(d-26), blad_e=abs(e-26))
bp_4_errors <- bp_4_data %>%
  summarise(a = mean(blad_a), b = mean(blad_b), 
            c = mean(blad_c), d = mean(blad_d),
            e = mean(blad_e))

plots_1 <- data.frame(x = rep(colnames(pp_1_errors), 2), y = c(as.numeric(pp_1_errors[1,]), as.numeric(bp_1_errors[1,])), typ = c(rep("pie plot", 4), rep("bar plot", 4)))
plots_2<- data.frame(x = rep(colnames(pp_2_errors), 2), y = c(as.numeric(pp_2_errors[1,]), as.numeric(bp_2_errors[1,])), typ = c(rep("pie plot", 5), rep("bar plot", 5)))
plots_3 <- data.frame(x = rep(colnames(pp_3_errors), 2), y = c(as.numeric(pp_3_errors[1,]), as.numeric(bp_3_errors[1,])), typ = c(rep("pie plot", 4), rep("bar plot", 4)))
plots_4 <- data.frame(x = rep(colnames(pp_4_errors), 2), y = c(as.numeric(pp_4_errors[1,]), as.numeric(bp_4_errors[1,])), typ = c(rep("pie plot", 5), rep("bar plot", 5)))

library(ggplot2)
p_1 <- ggplot(plots_1, aes(x = x, y = y, color = typ)) +
  geom_point() +
  ggtitle("Bledy bezwzgledne dla poszczególnych slupków. Para 1")

p_2 <- ggplot(plots_2, aes(x = x, y = y, color = typ)) +
  geom_point() +
  ggtitle("Bledy bezwzgledne dla poszczególnych slupków. Para 2")

p_3 <- ggplot(plots_3, aes(x = x, y = y, color = typ)) +
  geom_point() +
  ggtitle("Bledy bezwzgledne dla poszczególnych slupków. Para 3")

p_4 <- ggplot(plots_4, aes(x = x, y = y, color = typ)) +
  geom_point() +
  ggtitle("Bledy bezwzgledne dla poszczególnych slupków. Para 4")
  


